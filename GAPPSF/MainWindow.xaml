<Window
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:p="clr-namespace:GAPPSF.Core"
        xmlns:l="clr-namespace:GAPPSF.Localization"
        xmlns:c="clr-namespace:GAPPSF.Clipboard"
        xmlns:UIControls="clr-namespace:GAPPSF.UIControls" 
        x:Class="GAPPSF.MainWindow"
        IsEnabled="{Binding UIIsIdle, Source={x:Static p:ApplicationData.Instance}}"
        Title="{l:Translate MainWindowTitle}"
        Height="{Binding MainWindowHeight, Mode=TwoWay, Source={x:Static p:Settings.Default}}" 
        Width="{Binding MainWindowWidth, Mode=TwoWay, Source={x:Static p:Settings.Default}}"
        Left="{Binding MainWindowLeft, Mode=TwoWay, Source={x:Static p:Settings.Default}}"
        Top="{Binding MainWindowTop, Mode=TwoWay, Source={x:Static p:Settings.Default}}" Closing="Window_Closing" Background="#FF293955" Icon="Resources/MainWindow/Globalcaching.ico"
    ContentRendered="Window_ContentRendered">
    <Grid x:Name="layoutRoot">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <StackPanel Grid.Row="0">
            <Menu Background="#FFD6DBE9">
                <MenuItem Header="{l:Translate File}">
                    <MenuItem Header="{l:Translate New}" Command="{Binding NewCommand}" />
                    <MenuItem Header="{l:Translate Open}" Command="{Binding OpenCommand}"/>
                    <MenuItem Header="{l:Translate Import}">
                        <MenuItem Header="{l:Translate GPX}" Command="{Binding ImportGPXCommand}" />
                        <MenuItem Header="{l:Translate GAPPDataStorage}" Command="{Binding ImportGAPPCommand}" />
                    </MenuItem>
                </MenuItem>
                <MenuItem Header="{l:Translate Edit}">
                    <MenuItem Header="{l:Translate Copy}" Command="{Binding CopyCommand, Source={x:Static c:ClipboardHandler.Instance}}" />
                    <MenuItem Header="{l:Translate Delete}" Command="{Binding DeleteActiveCommand}" />
                    <MenuItem Header="{l:Translate CopySelection}" Command="{Binding CopySelectedCommand, Source={x:Static c:ClipboardHandler.Instance}}" />
                    <MenuItem Header="{l:Translate DeleteSelection}" Command="{Binding DeleteSelectionCommand}" />
                    <MenuItem Header="{l:Translate Paste}" Command="{Binding PasteCommand, Source={x:Static c:ClipboardHandler.Instance}}" />
                    <Separator />
                    <MenuItem Header="{l:Translate SelectAll}" Command="{Binding SelectAllCommand}" />
                    <MenuItem Header="{l:Translate ClearSelection}" Command="{Binding SelectNoneCommand}" />
                </MenuItem>
                <MenuItem Header="{l:Translate Search}">
                    <MenuItem Header="{l:Translate QuickSearch}">
                        <MenuItem Header="{l:Translate Archived}" Command="{Binding SelectArchivedCommand}" />
                    </MenuItem>
                </MenuItem>
                <MenuItem Header="{l:Translate Action}">
                </MenuItem>
                <MenuItem Header="{l:Translate LiveAPI}">
                    <MenuItem Header="{l:Translate Authorize}" Command="{Binding LiveApiAuthorizeCommand}" />
                </MenuItem>
                <MenuItem Header="{l:Translate Language}">
                    <MenuItem Header="{l:Translate OriginalText}" Click="MenuItem_Click_2"  />
                    <MenuItem Header="{l:Translate English}" Click="MenuItem_Click_3">
                        <MenuItem.Icon>
                            <Image Source="/Resources/MainWindow/en.gif" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem Header="{l:Translate German}" Click="MenuItem_Click_4">
                        <MenuItem.Icon>
                            <Image Source="/Resources/MainWindow/de.gif" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem Header="{l:Translate French}" Click="MenuItem_Click_5">
                        <MenuItem.Icon>
                            <Image Source="/Resources/MainWindow/fr.gif" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem Header="{l:Translate Dutch}" Click="MenuItem_Click_6">
                        <MenuItem.Icon>
                            <Image Source="/Resources/MainWindow/nl.gif" />
                        </MenuItem.Icon>
                    </MenuItem>
                </MenuItem>
                <MenuItem Header="{l:Translate Settings}">
                    <MenuItem Header="{l:Translate Shapefiles}" Click="MenuItem_Click_8" />
                </MenuItem>
                <MenuItem Header="{l:Translate Window}">
                    <MenuItem Header="{l:Translate CacheList}" Click="MenuItem_Click" />
                    <MenuItem Header="{l:Translate GeocacheViewer}" Click="MenuItem_Click_1" />
                    <MenuItem Header="{l:Translate ApplicationInfo}" Click="MenuItem_Click_10" />
                    <MenuItem Header="{l:Translate GeocacheFilter}" Click="MenuItem_Click_11" />
                    <MenuItem Header="{l:Translate Maps}">
                        <MenuItem Header="{l:Translate GoogleMap}" Click="MenuItem_Click_7" />
                    </MenuItem>
                    <MenuItem Header="{l:Translate OfflineImages}" Click="MenuItem_Click_9" />
                </MenuItem>
            </Menu>
            <ToolBarTray Background="#FFD6DBE9">
                <ToolBar Background="#FFCFD6E5">
                    <Button Command="{Binding NewCommand}">
                        <Image Source="/Resources/MainWindow/database_add.png"/>
                    </Button>
                    <Button Command="{Binding OpenCommand}">
                        <Image Source="/Resources/MainWindow/database.png"/>
                    </Button>
                </ToolBar>
            </ToolBarTray>
        </StackPanel>
        <Grid Grid.Row="1" x:Name="expandedView" Visibility="Collapsed">
            <UIControls:UIControlContainer x:Name="expandedPanelContent" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" />
        </Grid>
        <Grid x:Name="normalView" Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <Grid Grid.Column="0">
                <Expander  ExpandDirection="Right" HorizontalAlignment="Left" IsExpanded="{Binding MainWindowLeftPanelIsExpanded, Mode=TwoWay, Source={x:Static p:Settings.Default}}" Background="#FF293955" Foreground="White">
                    <Expander.Header>
                        <TextBlock Text="{Binding ElementName=leftPanelContent, Path=Text}" VerticalAlignment="Stretch">
                            <TextBlock.LayoutTransform>
                                <RotateTransform Angle="90"/>
                            </TextBlock.LayoutTransform>
                        </TextBlock>
                    </Expander.Header>
                    <Expander.Content>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="{Binding MainWindowLeftPanelWidth, Mode=TwoWay, Source={x:Static p:Settings.Default}}"/>
                                <ColumnDefinition Width="5"/>
                            </Grid.ColumnDefinitions>
                            <Grid Grid.Column="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                <UIControls:UIControlContainer x:Name="leftPanelContent" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" />
                            </Grid>
                            <GridSplitter Background="#FF293955" Grid.Column="1" Width="5" HorizontalAlignment="Right" ResizeBehavior="PreviousAndCurrent" ResizeDirection="Columns"/>
                        </Grid>
                    </Expander.Content>
                </Expander>
            </Grid>
            <Grid Grid.Column="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid Grid.Row="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="0,1,0,0">
                    <UIControls:UIControlContainer x:Name="topPanelContent" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" />
                </Grid>
                <Grid Grid.Row="1">
                    <Expander Background="#FF293955" Foreground="White" ExpandDirection="Up" VerticalAlignment="Top" IsExpanded="{Binding MainWindowBottomPanelIsExpanded, Mode=TwoWay, Source={x:Static p:Settings.Default}}">
                        <Expander.Header>
                            <TextBlock>
                                <TextBlock.Text>
                                    <MultiBinding StringFormat="Left: {0},   Right: {1}">
                                        <Binding ElementName="bottomLeftPanelContent" Path="Text" />
                                        <Binding ElementName="bottomRightPanelContent" Path="Text" />
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>
                        </Expander.Header>
                        <Expander.Content>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*" MinHeight="5" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <GridSplitter Background="#FF293955" Grid.Row="0" Height="5" ResizeDirection="Rows" ResizeBehavior="CurrentAndNext" HorizontalAlignment="Stretch" VerticalAlignment="Top"/>
                                <Grid Grid.Row="1">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="5" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Grid Grid.Column="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                        <UIControls:UIControlContainer x:Name="bottomLeftPanelContent" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" />
                                    </Grid>
                                    <GridSplitter Grid.Column="1" Background="#FF293955" Width="5" ResizeBehavior="PreviousAndNext" ResizeDirection="Columns"/>
                                    <Grid Grid.Column="2" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.ColumnSpan="2" Margin="0,0,0.4,-0.2">
                                        <UIControls:UIControlContainer x:Name="bottomRightPanelContent" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" />
                                    </Grid>
                                </Grid>
                            </Grid>
                        </Expander.Content>
                    </Expander>
                </Grid>
            </Grid>
            <Grid Grid.Column="2">
                <Expander Background="#FF293955" Foreground="White" ExpandDirection="Left" HorizontalAlignment="Right" IsExpanded="{Binding MainWindowRightPanelIsExpanded, Mode=TwoWay, Source={x:Static p:Settings.Default}}">
                    <Expander.Header>
                        <TextBlock Text="{Binding ElementName=rightPanelContent, Path=Text}">
                            <TextBlock.LayoutTransform>
                                <RotateTransform Angle="90"/>
                            </TextBlock.LayoutTransform>
                        </TextBlock>
                    </Expander.Header>
                    <Expander.Content>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <GridSplitter Background="#FF293955" Grid.Column="0" Width="5" ResizeDirection="Columns" ResizeBehavior="CurrentAndNext" HorizontalAlignment="Left" />
                            <Grid Grid.Column="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                <UIControls:UIControlContainer x:Name="rightPanelContent" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" />
                            </Grid>
                        </Grid>
                    </Expander.Content>
                </Expander>
            </Grid>
        </Grid>
        <Grid Grid.Row="2" Background="#FF007ACC">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <TextBlock Grid.Column="0" Foreground="White" Margin="4">
                <TextBlock.Text>
                    <MultiBinding StringFormat="{}{0} ({1})">
                        <Binding Source="{x:Static p:ApplicationData.Instance}" Path="ActiveDatabase.Text" />
                        <Binding Path="GeocacheSelectionCount" />
                    </MultiBinding>
                </TextBlock.Text>
            </TextBlock>
            <TextBlock Grid.Column="1"  Margin="4" Text="{Binding Source={x:Static p:ApplicationData.Instance}, Path=ActiveGeocache.Name}" TextDecorations="Underline" MouseUp="TextBlock_MouseUp">
                <TextBlock.Style>
                    <Style TargetType="{x:Type TextBlock}">
                        <Style.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Foreground" Value="Yellow" />
                                <Setter Property="Cursor" Value="Hand" />
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="False">
                                <Setter Property="Foreground" Value="White" />
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </TextBlock.Style>
            </TextBlock>
        </Grid>
    </Grid>
</Window>
